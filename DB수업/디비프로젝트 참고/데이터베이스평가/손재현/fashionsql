CREATE TABLE membertbl (
    memberid   CHAR(8) NOT NULL,
    membername NCHAR(4) NOT NULL,
    addr       NVARCHAR2(10) NOT NULL,
    mobile1    CHAR(3),
    mobile2    CHAR(8),
    height     NUMBER(3) NOT NULL
);

ALTER TABLE membertbl ADD CONSTRAINT membertbl_pk PRIMARY KEY ( memberid );

CREATE TABLE oredrtbl (
    memeber_id               CHAR(8) NOT NULL,
    member_name              NCHAR(4) NOT NULL,
    product_name             NCHAR(6) NOT NULL,
    amount                   INTEGER
);

ALTER TABLE oredrtbl ADD CONSTRAINT oredrtbl_pk PRIMARY KEY ( memeber_id );

CREATE TABLE shoestbl (
    shoesname NCHAR(6) NOT NULL,
    cost      NUMBER(6) NOT NULL,
    makedate  DATE,
    amount    NUMBER(2) NOT NULL
);

ALTER TABLE shoestbl ADD CONSTRAINT shoestbl_pk PRIMARY KEY ( shoesname );

CREATE TABLE toptbl (
    topname  NCHAR(4) NOT NULL,
    cost     NUMBER(6) NOT NULL,
    makedate DATE,
    amount   NUMBER(3) NOT NULL
);

ALTER TABLE toptbl ADD CONSTRAINT toptbl_pk PRIMARY KEY ( topname );

CREATE TABLE trouserstbl (
    trousersname NCHAR(4) NOT NULL,
    cost         NUMBER(6) NOT NULL,
    makedate     DATE,
    amount       NUMBER(3) NOT NULL
);

ALTER TABLE trouserstbl ADD CONSTRAINT trouserstbl_pk PRIMARY KEY ( trousersname );

ALTER TABLE oredrtbl
    ADD CONSTRAINT oredrtbl_membertbl_fk FOREIGN KEY ( membertbl_memberid )
        REFERENCES membertbl ( memberid );

ALTER TABLE oredrtbl
    ADD CONSTRAINT oredrtbl_shoestbl_fk FOREIGN KEY ( shoestbl_shoesname )
        REFERENCES shoestbl ( shoesname );

ALTER TABLE oredrtbl
    ADD CONSTRAINT oredrtbl_toptbl_fk FOREIGN KEY ( toptbl_topname )
        REFERENCES toptbl ( topname );

ALTER TABLE oredrtbl
    ADD CONSTRAINT oredrtbl_trouserstbl_fk FOREIGN KEY ( trouserstbl_trousersname )
        REFERENCES trouserstbl ( trousersname );
create sequence idSEQ;

insert into membertbl values('sjh','손재현','칠곡','010','11111111',173);
insert into membertbl values('yhr','양하람','칠곡','011','22222222',175);
insert into membertbl values('kjh','김지훈','서울','012','33333333',184);
insert into membertbl values('ksy','김신영','구미','013','44444444',170);
insert into membertbl values('lts','이태석','부산','014','55555555',181);


insert into shoestbl values('운동화',10000,'19/05/05',10);
insert into shoestbl values('샌들',10000,'21/01/15',10);
insert into shoestbl values('스니커즈',15000,'20/12/30',10);
insert into shoestbl values('슬리퍼',5000,'18/04/20',10);
insert into shoestbl values('워커',20000,'22/02/15',10);


insert into toptbl values('반팔티',8000,'18/11/20',15);
insert into toptbl values('긴팔티',10000,'20/05/20',15);
insert into toptbl values('후드티',13000,'22/01/05',15);
insert into toptbl values('셔츠',15000,'21/08/13',15);
insert into toptbl values('맨투맨',10000,'21/05/29',15);

insert into trouserstbl values('슬랙스',15000,'18/07/25',15);
insert into trouserstbl values('청바지',15000,'20/10/03',15);
insert into trouserstbl values('반바지',10000,'17/05/20',15);
insert into trouserstbl values('면바지',15000,'19/10/31',15);
insert into trouserstbl values('트레이닝바지',10000,'20/04/17',15);


select * from membertbl;
select * from oredrtbl;
select * from shoestbl;
select * from toptbl;
select * from trouserstbl;
--칼럼 전체 수정
update membertbl
set MOBILE1='010';
--맴버조회
select * from membertbl
where memberid='yhr';

--회원주소변경
update membertbl
set addr='대구'
where memberid='yhr';

--제고관리
select * from shoestbl
order by amount;
select * from toptbl
order by amount;
select * from trouserstbl
order by amount;

alter table oredrtbl drop column membertbl_memberid;
alter table oredrtbl drop column toptbl_topname;
alter table oredrtbl drop column TROUSERSTBL_TROUSERSNAME;
alter table oredrtbl drop column SHOESTBL_SHOESNAME;

insert into oredrtbl values ('sjh','손재현','청바지',1);
insert into oredrtbl values ('yhr','양하람','긴팔티',1);
insert into oredrtbl values ('yhr','양하람','슬랙스',1);
insert into oredrtbl values ('kjh','김지훈','스니커즈',1);
insert into oredrtbl values ('kjh','김지훈','맨투맨',1);
insert into oredrtbl values ('its','이태석','셔츠',1);
insert into oredrtbl values ('ksy','김신영','슬리퍼',1);
insert into oredrtbl values ('ksy','김신영','청바지',2);



--삭제
 delete from membertbl where membername ='이태석';
 delete from oredrtbl where memeber_id = 'its';  

select * from membertbl;

--주문내역조회
select* from oredrtbl;

select * from oredrtbl o
inner join membertbl m
on o.memeber_id=m.memberid
inner join shoestbl s
on o.product_name=s.shoesname;
select * from oredrtbl o
inner join membertbl m
on o.memeber_id=m.memberid
inner join toptbl t
on o.product_name=t.topname;
select * from oredrtbl o
inner join membertbl m
on o.memeber_id=m.memberid
inner join trouserstbl r
on o.product_name=r.trousersname;

--이전주문내역
select * from oredrtbl b
inner join membertbl m on b.memeber_id=m.memberid
where b.memeber_id='yhr';
--
--회원정보
select *from membertbl;
select distinct membername as "회원이름",addr as "지역",mobile1,mobile2 from membertbl;

--회원탈퇴
delete from membertbl where membername='';

--사용
select memeber_id as "회원아이디",member_name as "회원이름" ,product_name as "상품",amount as "갯수"from oredrtbl order by member_name;

--총 구매횟수
select member_name as "회원이름" , sum(amount) as"총 구매" from oredrtbl group by member_name;
--총 판매 횟수
select product_name as "상품" , sum(amount) as"총 판매" from oredrtbl group by product_name;
--

--as
--뷰 생성
create or replace view v_oredr_all
as select * from oredrtbl o
inner join membertbl m
on o.memeber_id=m.memberid

inner join shoestbl s
on o.product_name=s.shoesname

inner join toptbl t
on o.product_name=t.topname

inner join trouserstbl r
on o.product_name=r.trousersname;
